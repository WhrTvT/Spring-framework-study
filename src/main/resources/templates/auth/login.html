<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>로그인</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/sign-in/">

    <!-- Bootstrap core CSS -->
    <link href="/webjars/bootstrap/5.3.3/css/bootstrap.css" rel="stylesheet">

    <link href="../assets/signin.css" rel="stylesheet">
</head>
<body class="text-center">
<form id="login-form" class="form-signin">
    <img class="mb-4" src="../assets/bootstrap-solid.svg" alt="" width="72" height="72">
    <h1 class="h3 mb-3 font-weight-normal">로그인 페이지</h1>
    <label for="inputUser" class="sr-only">사용자명</label>
    <input type="text" id="inputUser" class="form-control" placeholder="Username" required autofocus>
    <label for="inputPassword" class="sr-only">비밀번호</label>
    <input type="password" id="inputPassword" class="form-control" placeholder="Password" required>
    <div class="checkbox mb-3">
        <label>
            <input type="checkbox" value="remember-me"> 기억하기
        </label>
    </div>
    <button class="btn btn-lg btn-primary btn-block" type="submit">로그인</button>
    <button class="btn btn-lg btn-secondary btn-block" id="signup-button" type="button">회원가입</button>
    <p class="mt-5 mb-3 text-muted">&copy; 2017-2020</p>
</form>
<script src="/webjars/jquery/3.7.1/dist/jquery.min.js"></script>
<script src="/webjars/bootstrap/5.3.3/js/bootstrap.min.js"></script>
<script>
    // 로그인 폼 제출
    document.getElementById('login-form').addEventListener('submit', async function (e) {
        e.preventDefault();
        const username = document.getElementById('inputUser').value;
        const password = document.getElementById('inputPassword').value;

        const response = await fetch('/api/auth/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ username, password }),
        });

        if (response.ok) {
            const data = await response.json();
            const token = data.data.accessToken; // 서버에서 반환된 JWT 토큰
            localStorage.setItem('jwtToken', token); // 토큰을 localStorage에 저장
            alert('로그인 성공');
            window.location.href = '/board'; // 로그인 성공 시 리디렉션
        } else {
            alert('로그인에 실패했습니다. 다시 시도해주세요.');
        }
    });

    // 회원가입 페이지로 이동
    document.getElementById('signup-button').addEventListener('click', function () {
        window.location.href = '/auth/signup';
    });
</script>
</body>
</html>